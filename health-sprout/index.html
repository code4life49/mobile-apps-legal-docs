<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Health Sprout - æ³•å¾‹æ–‡æ¡£</title>
    <link rel="stylesheet" href="../assets/css/styles.css" />
    <style>
      .feedback-section {
        background: linear-gradient(135deg, #ff6b6b, #ff8a80);
        border-radius: 15px;
        padding: 30px;
        margin: 30px 0;
        box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
        color: white;
        position: relative;
        overflow: hidden;
      }
      .feedback-section::before {
        content: "";
        position: absolute;
        top: -50%;
        right: -50%;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        animation: pulse 3s infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 0.3;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.1;
        }
      }
      .feedback-header {
        position: relative;
        z-index: 2;
        text-align: center;
        margin-bottom: 25px;
      }
      .feedback-header h2 {
        font-size: 28px;
        margin: 0 0 10px 0;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }
      .feedback-header .emoji {
        font-size: 40px;
        margin-bottom: 15px;
        display: block;
        animation: bounce 2s infinite;
      }
      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }
      .feedback-content {
        position: relative;
        z-index: 2;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 12px;
        padding: 25px;
        color: #333;
      }
      .feedback-intro {
        text-align: center;
        margin-bottom: 25px;
        color: #666;
        font-size: 16px;
        line-height: 1.6;
      }
      .form-group {
        margin-bottom: 20px;
      }
      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
        color: #333;
      }
      .form-group input,
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 6px;
        font-size: 14px;
        transition: border-color 0.3s ease;
        box-sizing: border-box;
      }
      .form-group input:focus,
      .form-group select:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #ff6b6b;
        box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
      }
      .form-group textarea {
        height: 120px;
        resize: vertical;
      }
      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }
      @media (max-width: 768px) {
        .form-row {
          grid-template-columns: 1fr;
        }
      }
      .submit-btn {
        background: linear-gradient(135deg, #ff6b6b, #ff5252);
        color: white;
        padding: 15px 30px;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        width: 100%;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
      }
      .submit-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
      }
      .submit-btn:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }
      .alert {
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 8px;
        font-weight: bold;
        text-align: center;
        display: none;
      }
      .alert-success {
        background-color: #d4edda;
        border: 2px solid #28a745;
        color: #155724;
      }
      .alert-error {
        background-color: #f8d7da;
        border: 2px solid #dc3545;
        color: #721c24;
      }
      .highlight-features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }
      .feature-item {
        background: rgba(255, 107, 107, 0.1);
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        border: 2px solid rgba(255, 107, 107, 0.2);
      }
      .feature-item .icon {
        font-size: 24px;
        margin-bottom: 8px;
        display: block;
      }
      .feature-item .text {
        font-size: 14px;
        font-weight: bold;
        color: #ff4444;
      }
    </style>
  </head>
  <body>
    <nav class="doc-nav">
      <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›ä¸»é¡µ</a>
        <span>Health Sprout</span>
      </div>
    </nav>

    <header>
      <div class="app-header-with-logo">
        <div class="app-logo-large">
          <img src="../assets/images/healthsprout.png" alt="Health Sprout Logo" />
        </div>
        <div class="app-header-content">
          <h1>Health Sprout</h1>
          <p>æ­¥æ•°å…»æ ‘åº”ç”¨ - æ³•å¾‹æ–‡æ¡£</p>
          <div class="app-meta">
            <span class="app-version">ç‰ˆæœ¬ 1.0.0</span>
            <span class="app-developer">å¼€å‘è€…ï¼šcode4life</span>
          </div>
        </div>
      </div>
    </header>

    <main>
      <div class="container">
        <!-- é†’ç›®çš„åé¦ˆåŒºåŸŸ -->
        <div class="feedback-section">
          <div class="feedback-header">
            <span class="emoji">ğŸ“¢</span>
            <h2>ç”¨æˆ·åé¦ˆä¸æŠ•è¯‰ä¸­å¿ƒ</h2>
            <p>æ‚¨çš„å£°éŸ³å¾ˆé‡è¦ï¼æœ‰é—®é¢˜ã€å»ºè®®æˆ–éœ€è¦å¸®åŠ©ï¼Ÿæˆ‘ä»¬éšæ—¶ä¸ºæ‚¨æœåŠ¡</p>
          </div>

          <div class="feedback-content">
            <div class="feedback-intro">
              <div class="highlight-features">
                <div class="feature-item">
                  <span class="icon">ğŸ›</span>
                  <div class="text">é—®é¢˜æŠ¥å‘Š</div>
                </div>
                <div class="feature-item">
                  <span class="icon">ğŸ’¡</span>
                  <div class="text">åŠŸèƒ½å»ºè®®</div>
                </div>
                <div class="feature-item">
                  <span class="icon">âš ï¸</span>
                  <div class="text">æŠ•è¯‰å¤„ç†</div>
                </div>
                <div class="feature-item">
                  <span class="icon">ğŸ—‘ï¸</span>
                  <div class="text">æ•°æ®åˆ é™¤</div>
                </div>
              </div>
              <p><strong>æ‰¿è¯ºï¼š24å°æ—¶å†…å›å¤ | ä¸“ä¸šå®¢æœå›¢é˜Ÿ | éšç§ä¿æŠ¤</strong></p>
            </div>

            <div id="alertContainer"></div>

            <form id="feedbackForm">
              <div class="form-row">
                <div class="form-group">
                  <label for="userName">å§“å *</label>
                  <input type="text" id="userName" name="userName" required />
                </div>
                <div class="form-group">
                  <label for="userEmail">é‚®ç®± *</label>
                  <input type="email" id="userEmail" name="userEmail" required />
                </div>
              </div>

              <div class="form-group">
                <label for="feedbackType">åé¦ˆç±»å‹ *</label>
                <select id="feedbackType" name="feedbackType" required>
                  <option value="">è¯·é€‰æ‹©åé¦ˆç±»å‹...</option>
                  <option value="bug">ğŸ› é—®é¢˜æŠ¥å‘Š</option>
                  <option value="suggestion">ğŸ’¡ åŠŸèƒ½å»ºè®®</option>
                  <option value="complaint">âš ï¸ æŠ•è¯‰</option>
                  <option value="data-deletion">ğŸ—‘ï¸ æ•°æ®åˆ é™¤è¯·æ±‚</option>
                  <option value="other">ğŸ¤” å…¶ä»–</option>
                </select>
              </div>

              <div class="form-group">
                <label for="message">è¯¦ç»†æè¿° *</label>
                <textarea id="message" name="message" placeholder="è¯·è¯¦ç»†æè¿°æ‚¨çš„é—®é¢˜ã€å»ºè®®æˆ–éœ€æ±‚ã€‚å¦‚æœæ˜¯æ•°æ®åˆ é™¤è¯·æ±‚ï¼Œè¯·è¯´æ˜éœ€è¦åˆ é™¤çš„å…·ä½“æ•°æ®èŒƒå›´..." required></textarea>
              </div>

              <button type="submit" class="submit-btn" id="submitBtn">ğŸš€ ç«‹å³å‘é€åé¦ˆ</button>
            </form>
          </div>
        </div>

        <div class="apps-grid">
          <div class="app-card">
            <div class="doc-icon">ğŸ“„</div>
            <h2>éšç§æ”¿ç­–</h2>
            <p>äº†è§£æˆ‘ä»¬å¦‚ä½•æ”¶é›†å’Œä¿æŠ¤æ‚¨çš„æ­¥æ•°æ•°æ®åŠè™šæ‹Ÿæ ‘è‹—åŸ¹è‚²ä¿¡æ¯</p>
            <div class="doc-meta">
              <span>æœ€åæ›´æ–°ï¼š2025å¹´7æœˆ8æ—¥</span>
            </div>
            <div class="app-links">
              <a href="privacy-policy.html" class="btn btn-primary">æŸ¥çœ‹è¯¦æƒ…</a>
            </div>
          </div>

          <div class="app-card">
            <div class="doc-icon">ğŸ“‹</div>
            <h2>ç”¨æˆ·åè®®</h2>
            <p>ä½¿ç”¨Health Sproutæ­¥æ•°å…»æ ‘åŠŸèƒ½çš„æ¡æ¬¾å’Œæ¡ä»¶</p>
            <div class="doc-meta">
              <span>æœ€åæ›´æ–°ï¼š2025å¹´7æœˆ8æ—¥</span>
            </div>
            <div class="app-links">
              <a href="terms-of-service.html" class="btn btn-primary">æŸ¥çœ‹è¯¦æƒ…</a>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <p>&copy; 2024 Health Sprout. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
    </footer>

    <script src="../assets/js/main.js"></script>
    <!-- EmailJS SDK - ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script>
      // åˆå§‹åŒ– EmailJS
      (function () {
        emailjs.init({
          publicKey: "TLExDF9i3h_lTFHO5",
        });
      })();

      // è¡¨å•æäº¤å¤„ç†
      document.getElementById("feedbackForm").addEventListener("submit", function (e) {
        e.preventDefault();

        const submitBtn = document.getElementById("submitBtn");
        const alertContainer = document.getElementById("alertContainer");

        // ç¦ç”¨æäº¤æŒ‰é’®
        submitBtn.disabled = true;
        submitBtn.textContent = "ğŸš€ å‘é€ä¸­...";

        // è·å–è¡¨å•æ•°æ®
        const formData = new FormData(this);
        const templateParams = {
          from_name: formData.get("userName"),
          from_email: formData.get("userEmail"),
          feedback_type: formData.get("feedbackType"),
          message: formData.get("message"),
          app_name: "Health Sprout",
          timestamp: new Date().toLocaleString("zh-CN"),
          to_email: "hk.code4life@gmail.com",
        };

        // ä½¿ç”¨ EmailJS å‘é€é‚®ä»¶
        emailjs
          .send("service_0ha5u4z", "template_5edbpuh", templateParams)
          .then(
            function (response) {
              console.log("é‚®ä»¶å‘é€æˆåŠŸ!", response.status, response.text);

              // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
              alertContainer.innerHTML = `
              <div class="alert alert-success" style="display: block;">
                âœ… åé¦ˆå·²æˆåŠŸå‘é€ï¼æˆ‘ä»¬ä¼šåœ¨24å°æ—¶å†…å›å¤æ‚¨ã€‚
                <br><small>æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼Œæˆ‘ä»¬ä¼šè®¤çœŸå¤„ç†æ‚¨çš„æ„è§ã€‚</small>
              </div>
            `;

              // é‡ç½®è¡¨å•
              document.getElementById("feedbackForm").reset();

              // 5ç§’åéšè—æˆåŠŸæ¶ˆæ¯
              setTimeout(() => {
                alertContainer.innerHTML = "";
              }, 5000);
            },
            function (error) {
              console.error("é‚®ä»¶å‘é€å¤±è´¥:", error);

              // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯å¹¶æä¾›å¤‡ç”¨æ–¹æ¡ˆ
              alertContainer.innerHTML = `
              <div class="alert alert-error" style="display: block;">
                âŒ å‘é€å¤±è´¥ï¼Œè¯·å°è¯•ä»¥ä¸‹å¤‡ç”¨æ–¹æ¡ˆï¼š
                <br><strong>é‚®ç®±ï¼š</strong> <a href="mailto:support@shijingty.com" style="color: #721c24; text-decoration: underline;">support@shijingty.com</a>
                <br><small>æ‚¨ä¹Ÿå¯ä»¥ç›´æ¥å‘é€é‚®ä»¶ï¼Œæˆ‘ä»¬åŒæ ·ä¼šåŠæ—¶å›å¤</small>
              </div>
            `;
            }
          )
          .finally(() => {
            // æ¢å¤æäº¤æŒ‰é’®
            submitBtn.disabled = false;
            submitBtn.textContent = "ğŸš€ ç«‹å³å‘é€åé¦ˆ";
          });
      });

      // å¤‡ç”¨ï¼šå¦‚æœ EmailJS åŠ è½½å¤±è´¥ï¼Œå›é€€åˆ° mailto æ–¹å¼
      window.addEventListener("load", function () {
        setTimeout(() => {
          if (typeof emailjs === "undefined") {
            console.warn("EmailJS åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨ mailto å¤‡ç”¨æ–¹æ¡ˆ");
            setupMailtoFallback();
          }
        }, 3000);
      });

      // mailto å¤‡ç”¨æ–¹æ¡ˆ
      function setupMailtoFallback() {
        const form = document.getElementById("feedbackForm");
        const newForm = form.cloneNode(true);
        form.parentNode.replaceChild(newForm, form);

        newForm.addEventListener("submit", function (e) {
          e.preventDefault();

          const formData = new FormData(this);
          const emailBody = `
ç”¨æˆ·åé¦ˆ - Health Sprout

å§“åï¼š${formData.get("userName")}
é‚®ç®±ï¼š${formData.get("userEmail")}
åé¦ˆç±»å‹ï¼š${formData.get("feedbackType")}
æäº¤æ—¶é—´ï¼š${new Date().toLocaleString("zh-CN")}

è¯¦ç»†å†…å®¹ï¼š
${formData.get("message")}

---
æ­¤é‚®ä»¶æ¥è‡ª Health Sprout ç”¨æˆ·åé¦ˆç³»ç»Ÿ
          `.trim();

          const mailtoLink = `mailto:support@shijingty.com?subject=${encodeURIComponent("Health Sprout ç”¨æˆ·åé¦ˆ - " + formData.get("feedbackType"))}&body=${encodeURIComponent(emailBody)}`;
          window.location.href = mailtoLink;

          document.getElementById("alertContainer").innerHTML = `
            <div class="alert alert-success" style="display: block;">
              ğŸ“§ å·²ä¸ºæ‚¨æ‰“å¼€é‚®ä»¶å®¢æˆ·ç«¯ï¼Œè¯·å®Œæˆå‘é€ã€‚
              <br><small>å¦‚æœæœªè‡ªåŠ¨æ‰“å¼€ï¼Œè¯·æ‰‹åŠ¨å‘é€é‚®ä»¶è‡³ support@shijingty.com</small>
            </div>
          `;
        });
      }
    </script>
  </body>
</html>
